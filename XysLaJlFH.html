<!DOCTYPE html>
<html>
	<head>
	<meta charset="utf-8"> 
	<title>Confidence intervals of simple linear regression.</title>
    <meta name="author" content="Riccardo Scalco">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Data Journalism, Italy, Riccardo Scalco, Analytic Journalism, Data Driven Journalism,
    Data Visualization, Data Analysis, Web Spidering, Data scientist, Data
    artist, interactive things, web design, web developer">
    <meta name="p:domain_verify" content="b3d94f28f62c80bf62cae5db9c620773"/>
    <!--<meta name="description" content="">-->
    <link rel="alternate" href="/atom.xml" type="application/atom+xml" title="eidogram">
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" href="normalize.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css">
    <link rel="stylesheet" href="font/font-awesome/css/font-awesome.min.css">
    <link rel="prefetch" href="http://eidogram.com/projects/piemVisCont/"/>
    <!--<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>-->
    <!--<script src="http://code.jquery.com/jquery-migrate-1.1.1.min.js"></script>-->
    <!--<script type="text/javascript" src="js/jquery.min.js"></script>-->

    
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="js/highlight/highlight.pack.js"></script>
    

    
    <link rel="stylesheet" href="js/highlight/styles/github.css" type="text/css">
    

    <!--
    
    -->

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-28849332-2', 'eidogram.com');
      ga('send', 'pageview');
    </script>
    </head>
    <body id="top">
    <div id="info">
        <a class="logo" href="/">
        <img class="logo" src="/logo.png" alt="eidogram">
        </a>
        <aside>
        <p>
            I am Riccardo Scalco, an italian freelancer in Information Design.
            I like to turn raw data in knowledge through the combination of advanced mathematics and beautiful visualizations.
            Eidogram is the place where I collect projects and experiments, please enjoy.<br><br>
        <!--For work enquiries, or simply to say hello, email me at riccardo.scalco[at]gmail.com.-->
        (Oh.. Iâ€™m up for some collabs right now)
        </p>
        <ul>
         <a href="mailto:riccardo.scalco@gmail.com"><i class="fa fa-envelope"></i></a>
         <a href="https://github.com/riccardoscalco"><i class="fa fa-github-alt"></i></a>
         <a href="https://twitter.com/eidogram"><i class="fa fa-twitter"></i></a>
         <a href="http://pinterest.com/riccardoscalco/"><i class="fa fa-pinterest"></i></a>
         <a href="http://it.linkedin.com/pub/riccardo-scalco/88/408/98b"><i class="fa fa-linkedin"></i></a>
         <a href="/atom.xml"><i class="fa fa-rss"></i></li></a>
         </ul>

        <!--<a href="articles.html">Grains of mathematics</a></li>-->
        <!--<li><a href="articles.html">Articles</a></li>
        <<li><a href="portfolio.html">Data Artworks</a></li>-->

        <p class="news">
            Recently I joined the <a href="http:/7tuxtax.ch">Tuxtax</a> team, an emerging laboratory on Data Visualization based in Milan and Lausanne.
        </p>

        <p class="news">
            You will find me as d3js tutor at the <a href="http://goo.gl/IyX4pR">Data Journalism Workshop</a> in Rome next March.
        </p>




         <div id="credits">
         <p>
         Website powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a><br>
         <!--CSS design inspired by <a href="http://jt.ms/">JT</a><br>-->
         Used typeface <a href="http://www.elenapapassissa.it/index.php?/typefaces/lekton/">Lekton</a><br>
         <!--and <a href="http://nicinabox.github.com/superslides/">Nic Aitch</a>-->
         Hosted on <a href="https://github.com/eidogram/eidogram.github.io">GitHub</a><br>
         &copy Copyright 2014<br>
         <a href="http://riccardoscalco.github.io/">Riccardo Scalco</a></br>
         VATIN: IT 03876810247
         <!--<a href="#top">Back to the top</a></p></br>-->
         </div>
      </aside>
      </div>
<div id="container">
    <article data-id="XysLaJlFH">
  <h1>Confidence intervals of simple linear regression.</h1>
  <!--<time>15 Jul 2013</time>-->
  <p>The following text is a brief summary of lectures 29,30 and 31 given by 
<a href="http://ocw.mit.edu/courses/mathematics/18-443-statistics-for-applications-fall-2003/index.htm">Dmitry Panchenko</a> at MIT.</p>

<p>Suppose we are given a set of observations <script type="math/tex">\{(X_1,Y_1),\dots,(X_n,Y_n)\}</script>, where <script type="math/tex">X_i,Y_i \in \mathbb{R}</script>.
We <em>assume</em> to model the random variable <script type="math/tex">Y</script> as a linear function of the random variable <script type="math/tex">X</script> with the presence of a random noise,
i.e. we are assuming</p>

<script type="math/tex; mode=display">
Y_i = b_0 + b_1 X_i + \epsilon_i
</script>

<p>where <script type="math/tex">b_0,b_1\in\mathbb{R}</script> and <script type="math/tex">\epsilon_i\sim N(0,\sigma^2)</script> (that is <script type="math/tex">\epsilon_i</script> is assumed to have normal distribution) are unknown parameters.
On the following we will estimate the unknown parameters and their confidence intervals, given the observations.</p>

<p>Let us think of the points <script type="math/tex">X_i</script> as fixed and <em>non random</em> and deal only with the randomness that comes from the noise variables <script type="math/tex">\epsilon_i</script>.
In other words we deal only with the distribution <script type="math/tex">P(Y_i)=f(X_i,b_0,b_1,\epsilon_i)</script>, which is normal because the randomness comes from the normal variables <script type="math/tex">\epsilon_i</script>.</p>

<p>We want to find the estimates <script type="math/tex">\hat{b_0}, \hat{b_1}</script> and <script type="math/tex">\hat{\sigma}^2</script> that fits the observations best and one can define the measure of the quality of fit in different ways. Here we use the maximum likelihood estimates, which maximize the probability <script type="math/tex">P(Y_1Y_2\dots Y_n)=P(Y_1)P(Y_2)\dots P(Y_n)</script>
of the event <script type="math/tex">Y_1 \text{ AND } Y_2 \text{ AND } \dots \text{ AND } Y_n</script>.
The maximum likelihood estimates are</p>

<script type="math/tex; mode=display">
\hat{b_1} = \frac{\bar{XY}-\bar{X}\bar{Y}}{\bar{X^2}-\bar{X}^2},\qquad

\hat{b_0} = \bar{Y} - \hat{b_1}\bar{X},\qquad

\hat{\sigma}^2 = \frac{1}{n}\sum^n_{i=1}(Y_i - \hat{b_0} - \hat{b_1}X_i)^2
</script>

<p>where <script type="math/tex">\bar{X}</script> is the mean of <script type="math/tex">X</script>
(note that <script type="math/tex">b_0</script> and <script type="math/tex">b_1</script> are the same as found with the least-squares method).</p>

<p><em>The knowledge of the estimates is enough to draw the line that fits the observations,
but an important further information (the confidence) comes from the distribution of the estimates.</em>
The estimates have a probability distribution because they are functions of <script type="math/tex">Y_i</script>, which have distributions <script type="math/tex">P(Y_i)</script>.</p>

<p>What are the confidence intervals? It will become apparent with an example. It can be proved that the random variable <script type="math/tex">\hat{\sigma}^2</script> is independent of <script type="math/tex">\hat{b_0}</script> and <script type="math/tex">\hat{b_1}</script>
and that it has a chi squared distribution with <script type="math/tex">n-2</script> degrees of freedom. In formulas</p>

<script type="math/tex; mode=display">
\frac{n\hat{\sigma}^2}{\sigma^2}\sim\chi^2_{n-2}.
</script>

<p>Note that <script type="math/tex">\chi^2_{n-2}</script> is a well known distribution, i.e. we can calculate probabilities with it. For example, let be <script type="math/tex">\alpha=0.025</script>, if we find the values <script type="math/tex">c_1</script> and <script type="math/tex">c_2</script> such that
<script type="math/tex">\int_0^{c_1}\chi^2_{n-2}dx=\alpha/2</script> and <script type="math/tex">\int_{c_2}^{\infty}\chi^2_{n-2}dx=\alpha/2</script>, then the probability of the remaining interval is <script type="math/tex">\int_{c_1}^{c_2}\chi^2_{n-2}dx=1-\alpha = 0.95</script>,
which means that</p>

<script type="math/tex; mode=display">
P(c_1\leq\frac{n\hat{\sigma}^2}{\sigma^2}\leq c_2) = 0.95.
</script>

<p><em>Solving for <script type="math/tex">\sigma^2</script> we find the <script type="math/tex">1-\alpha</script> confidence interval</em></p>

<script type="math/tex; mode=display">
\frac{n\hat{\sigma}^2}{c_2}\leq\sigma^2\leq\frac{n\hat{\sigma}^2}{c_1}.
</script>

<p>Note that the confidence interval is calculable.</p>

<p>With the same meaning, the <script type="math/tex">1-\alpha</script> confidence intervals of <script type="math/tex">b_1</script> and <script type="math/tex">b_0</script> are</p>

<script type="math/tex; mode=display">
\hat{b_1} - c \sqrt{\frac{\hat{\sigma}^2}{(n-2)(\bar{X^2}-\bar{X}^2)}} \leq b_1 \leq \hat{b_1} + c \sqrt{\frac{\hat{\sigma}^2}{(n-2)(\bar{X^2}-\bar{X}^2)}}
</script>

<script type="math/tex; mode=display">
\hat{b_0} - c \sqrt{\frac{\hat{\sigma}^2}{n-2}\left(1+\frac{\bar{X}^2}{\bar{X^2}-\bar{X}^2}\right)} \leq b_0 \leq \hat{b_0} + c \sqrt{\frac{\hat{\sigma}^2}{n-2}\left(1+\frac{\bar{X}^2}{\bar{X^2}-\bar{X}^2}\right)}
</script>

<p>where the value <script type="math/tex">c</script> originates from the Student distribution with <script type="math/tex">n-2</script> degrees of freedom: <script type="math/tex">t_{n-2}(-c,c)=1-\alpha</script>.</p>

<p>This is a Python2 script that calculates the estimates and the confidence intervals, it makes use of the Scipy and Numpy libraries.</p>

<script>hljs.initHighlightingOnLoad();</script>

<pre>
<code style="text-align:left; white-space:inherit">import scipy.stats, numpy
def linear_regression(x, y, prob):
    """
    Return the linear regression parameters and their <prob> confidence intervals.
    &gt;&gt;&gt; linear_regression([.1,.2,.3],[10,11,11.5],0.95)
    """
    x = numpy.array(x)
    y = numpy.array(y)
    n = len(x)
    xy = x * y
    xx = x * x

    # estimates

    b1 = (xy.mean() - x.mean() * y.mean()) / (xx.mean() - x.mean()**2)
    b0 = y.mean() - b1 * x.mean()
    s2 = 1./n * sum([(y[i] - b0 - b1 * x[i])**2 for i in xrange(n)])
    print 'b0 = ',b0
    print 'b1 = ',b1
    print 's2 = ',s2
    
    #confidence intervals
    
    alpha = 1 - prob
    c1 = scipy.stats.chi2.ppf(alpha/2.,n-2)
    c2 = scipy.stats.chi2.ppf(1-alpha/2.,n-2)
    print 'the confidence interval of s2 is: ',[n*s2/c2,n*s2/c1]
    
    c = -1 * scipy.stats.t.ppf(alpha/2.,n-2)
    bb1 = c * (s2 / ((n-2) * (xx.mean() - (x.mean())**2)))**.5
    print 'the confidence interval of b1 is: ',[b1-bb1,b1+bb1]
    
    bb0 = c * ((s2 / (n-2)) * (1 + (x.mean())**2 / (xx.mean() - (x.mean())**2)))**.5
    print 'the confidence interval of b0 is: ',[b0-bb0,b0+bb0]
    return None


</prob></code></pre>

</article>


<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'eidogram'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>
<!--
    <script>
    $(document).ready(function(){
      $('a[href=#top]').click(function() {
        $('html, body').animate({scrollTop: 0}, 'slow');
        return false;
      });
      $('a[href=#info]').click(function() {
        $('html, body').animate({scrollTop:$(document).height()}, 'slow');
        $('footer').css({'border-top-color': '#000', 'color': '#000'});
        return false;
      });
    });
    </script>
-->
    </body>
</html>

